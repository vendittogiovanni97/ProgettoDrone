generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum StatusDrone {
  ONLINE
  OFFLINE
}

enum MissionStatus {
  COMPLETED
  IN_PROGRESS
}

model UserAuthentication {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users") // Nome tabella nel database
}

model Drone {
  id           Int         @id @default(autoincrement())
  deviceId     String      @unique
  uniqueId     String      @unique
  status       StatusDrone @default(OFFLINE)
  batteryLevel Float?       @default(100.0) // Percentuale batteria

  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  missions     Mission[]   // Relazione con Mission

  @@map("drones") // Nome tabella nel database
}

model Mission {
  id            Int           @id @default(autoincrement())
  deviceId      String
  statusMission MissionStatus @default(IN_PROGRESS)
  startTime     DateTime
  endTime       DateTime?

  drone         Drone   @relation(fields: [deviceId], references: [deviceId])
  positionLogs  PositionLog[]  // Relazione con PositionLog

  @@map("missions") // Nome tabella nel database
}

model PositionLog {
  id        Int     @id @default(autoincrement())
  missionId Int
  lan       Float   // Latitudine
  lon       Float   // Longitudine

  mission   Mission @relation(fields: [missionId], references: [id])

  @@map("position_logs") // Nome tabella nel database
}